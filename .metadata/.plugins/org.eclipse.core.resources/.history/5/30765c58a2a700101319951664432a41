
package es.tributasenasturias.servicios.seguridadws;

import javax.jws.WebService;
import javax.xml.ws.BindingType;
import javax.xml.ws.Holder;

import org.apache.ws.security.WSSecurityException;

import es.tributasenasturias.servicios.seguridadws.implementacion.FirmaException;
import es.tributasenasturias.servicios.seguridadws.implementacion.FirmanteMensaje;
import es.tributasenasturias.servicios.seguridadws.implementacion.ValidacionConstants;
import es.tributasenasturias.servicios.seguridadws.implementacion.ValidadorException;
import es.tributasenasturias.servicios.seguridadws.implementacion.ValidadorFirma;

/**
 * This class was generated by the JAX-WS RI. Oracle JAX-WS 2.1.3-06/19/2008
 * 07:03 PM(bt) Generated source version: 2.1
 * 
 */
@WebService(portName = "SeguridadSOAP", serviceName = "Seguridad", targetNamespace = "http://www.tributasenasturias.es/SeguridadWS/", wsdlLocation = "/wsdls/Seguridad.wsdl", endpointInterface = "es.tributasenasturias.servicios.seguridadws.Seguridad")
@BindingType("http://schemas.xmlsoap.org/wsdl/soap/http")
public class Seguridad_SeguridadSOAPImpl implements Seguridad {

	public Seguridad_SeguridadSOAPImpl() {
	}

	/**
	 * 
	 * @param codigo
	 * @param error
	 * @param esError
	 * @param soapMsg
	 */
	public void validacionFirmaCompleta(String soapMsg,
			Holder<Boolean> esError, Holder<String> codigo, Holder<String> error) {
		try {
			ValidadorFirma validador= new ValidadorFirma();
			validador.validarFirma(soapMsg, ValidacionConstants.VALIDACION_COMPLETA);
			esError.value=false;
			codigo.value="0000";
			error.value="Mensaje validado correctamente";
		} catch (ValidadorException e) {
			esError.value=true;
			codigo.value="Error en la validación de seguridad.";
			error.value=e.getMessage();
		} catch (WSSecurityException e) {
			esError.value=true;
			codigo.value="Seguridad no válida.";
			error.value=e.getMessage();
		}
		
		return;
	}

	/**
	 * 
	 * @param codigo
	 * @param error
	 * @param esError
	 * @param soapMsg
	 */
	public void validacionFirmaSinCertificado(String soapMsg,
			Holder<Boolean> esError, Holder<String> codigo, Holder<String> error) {
		try {
			ValidadorFirma validador= new ValidadorFirma();
			validador.validarFirma(soapMsg, ValidacionConstants.VALIDACION_SIN_CERTIFICADO);
			esError.value=false;
			codigo.value="0000";
			error.value="Mensaje validado correctamente";
		} catch (ValidadorException e) {
			esError.value=true;
			codigo.value="Error en la validación de seguridad.";
			error.value=e.getMessage();
		} catch (WSSecurityException e) {
			esError.value=true;
			codigo.value="Seguridad no válida.";
			error.value=e.getMessage();
		}
	}

    /**
     * 
     * @param mensaje
     * @return
     *     returns java.lang.String
     */
    public String firmarMensaje(String mensaje, String aliasCertificado) {
        FirmanteMensaje firma=null;
        try {
        	firma=new FirmanteMensaje();
			return firma.firmaMensaje(mensaje, aliasCertificado);
		} catch (WSSecurityException e) {
			return null;
		} catch (FirmaException e) {
			return null;
		}
    }

}
